<!DOCTYPE html>
<html>

<head>
    <title>What to read today - multiple sections</title>

    <style type="text/css">
        body {
            margin: 1em auto;
            max-width: 40em;
            width: 88%;
        }

        article {
            margin-bottom: 3em;
        }
    </style>
</head>

<body>

    <h1>What to read today - multiple sections</h1>

    <h2>TOP STORIES</h2>

    <div id="app"></div>

    <h2>TOP SCIENCE</h2>
    <div id="science"></div>
    <!-- https://api.nytimes.com/svc/topstories/v2/science.json?api-key=yourkey -->
    <script>
        // Get the app
        var app = document.querySelector('#app');
        var science = document.querySelector('#science');

        // Store API key to a variable for easier access
        var apiKey = 'kmV2Q9qUq71GqgvMIv7xGL9v2ZWThHu3';

        // Set number of articles to show to a variable so it can be easily changed later
        var numberOfArticles = 3;

		/**
		 * Render articles into the DOM
		 * @param  {Array} articles The articles to render
		 */
        var render = function (articles) {

            // Create a new array of markup strings with array.map(), then
            // Combine them into one string with array.join(), then
            // Insert them into the DOM with innerHTML
            app.innerHTML = articles.map(function (article) {
                var html =
                    '<article>' +
                    '<h2><a href="' + article.url + '">' + article.title + '</a></h2>' +
                    '<p>' + article.byline + '</p>' +
                    '<p>' + article.abstract + '</p>' +
                    '</article>';
                return html;
            }).join('');

        };

        var render2 = function (articles) {

            // Create a new array of markup strings with array.map(), then
            // Combine them into one string with array.join(), then
            // Insert them into the DOM with innerHTML
            science.innerHTML = articles.map(function (article) {
                var html =
                    '<article>' +
                    '<h2><a href="' + article.url + '">' + article.title + '</a></h2>' +
                    '<p>' + article.byline + '</p>' +
                    '<p>' + article.abstract + '</p>' +
                    '</article>';
                return html;
            }).join('');

        };

		/**
		 * Get the first few articles from the full data set
		 * @param  {Array} articles The full set of articles
		 * @return {Array}          The first few
		 */
        var getFirstFew = function (articles) {
            return articles.slice(0, numberOfArticles);
        };

        // Get articles
        fetch('https://api.nytimes.com/svc/topstories/v2/home.json?api-key=' + apiKey).then(function (response) {
            if (response.ok) {
                return response.json();
            } else {
                return Promise.reject(response);
            }
        }).then(function (data) {

            // Get the first few articles
            var firstFew = getFirstFew(data.results);

            // Render them into the DOM
            render(firstFew);

        }).catch(function (error) {
            console.log('Something went wrong:', error);
        });

        // Get articles
        fetch('https://api.nytimes.com/svc/topstories/v2/science.json?api-key=' + apiKey).then(function (response) {
            if (response.ok) {
                return response.json();
            } else {
                return Promise.reject(response);
            }
        }).then(function (data) {

            // Get the first few articles
            var firstFew = getFirstFew(data.results);

            // Render them into the DOM
            render2(firstFew);

        }).catch(function (error) {
            console.log('Something went wrong:', error);
        });
    </script>
</body>

</html>